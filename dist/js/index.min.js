function makeGraphs(a,t,e){var n=crossfilter(t),r=n.dimension(function(a){return a.Category}),i=r.group().reduceCount(),c=n.dimension(dc.pluck("ParkName")),s=c.group().reduce(function(a,t){return a.count++,a.total+=t.Acres,a.average=a.total/a.count,a},function(a,t){return a.count--,0==a.count?(a.total=0,a.average=0):(a.total-=t.Acres,a.average=a.total/a.count),a},function(){return{count:0,total:0,average:0}});function u(e){return c.group().reduce(function(a,t){return a.total++,t.Category==e&&a.match++,a},function(a,t){return a.total--,t.Category==e&&a.match--,a},function(){return{total:0,match:0}})}var o=u("Algae"),l=u("Amphibian"),d=u("Bird"),g=u("Crab/Lobster/Shrimp"),p=u("Fish"),m=u("Fungi"),h=u("Insect"),k=u("Invertabrate"),v=u("Mammal"),f=u("Nonvascular Plant"),b=u("Reptile"),A=u("Slug/Snail"),C=u("Spider/Scorpion"),x=u("Vascular Plant");dc.pieChart("#num-species").height(600).radius(300).transitionDuration(1500).dimension(r).group(i).legend(dc.legend().x(40).y(0).gap(5)).externalLabels(50).externalRadiusPadding(50),dc.pieChart("#park-size").height(600).radius(300).transitionDuration(1500).dimension(c).group(s).legend(dc.legend().x(40).y(0).gap(5)).externalRadiusPadding(50).valueAccessor(function(a){return a.value.average});var P=dc.barChart("#speciescat-stack");P.width(1e3).height(1500).dimension(c).group(o,"Algae").stack(l,"Amphibian").stack(d,"Bird").stack(g,"Crustacean").stack(p,"Fish").stack(m,"Fungi").stack(h,"Insect").stack(k,"Invertabrate").stack(v,"Mammal").stack(f,"Nonvascular Plant").stack(b,"Reptile").stack(A,"Slug").stack(C,"Spider").stack(x,"Vascular Plant").valueAccessor(function(a){return a.value.match}).x(d3.scale.ordinal()).xUnits(dc.units.ordinal).legend(dc.legend().x(40).y(0).itemHeight(15).gap(5)),P.margins().left=300,P.margins().right=10,P.margins().top=10,P.margins().bottom=300,dc.renderAll()}queue().defer(d3.json,"data/akparks.json").await(makeGraphs);